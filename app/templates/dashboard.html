{% load mixpanel %}
{% load intercom %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <base href="/">
    <link rel="icon" type="image/x-icon" href="assets/img/favicon.png">
    <title>Integrates</title>
    <link rel="stylesheet" type="text/css" href="assets/amaretti/lib/stroke-7/style.css"/>
    <link rel="stylesheet" type="text/css" href="assets/amaretti/lib/jquery.nanoscroller/css/nanoscroller.css"/><!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="assets/amaretti/css/style.css" type="text/css"/>
    <link rel="stylesheet" type="text/css" href="assets/amaretti/lib/jquery.gritter/css/jquery.gritter.css"/>
    <link rel="stylesheet" href="assets/bower_components/bootstrap-table/dist/css/bootstrap-table.min.css" type="text/css"/>
    <link rel="stylesheet" href="assets/bower_components/angular-bootstrap/ui-bootstrap-csp.css" type="text/css">
    <link rel="stylesheet" href="assets/bower_components/ng-notify/dist/ng-notify.min.css" type="text/css">
    <link rel="stylesheet" href="assets/node_modules/magnific-popup/dist/magnific-popup.css" type="text/css">
    <link rel="stylesheet" href="assets/prismjs/prism.css" type="text/css">
    <link rel="stylesheet" href="assets/node_modules/jquery-comments_brainkit/css/jquery-comments.css" type="text/css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css">
    <script src="assets/bower_components/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="assets/amaretti/lib/jquery.nanoscroller/javascripts/jquery.nanoscroller.min.js" type="text/javascript"></script>
    <script src="assets/prismjs/prism.js" data-manual></script>

    {% mixpanel %}
    <script>
    mixpanel.identify("{{ request.session.username }}");
    mixpanel.people.set({
        "$email": "{{ request.session.username }}",
        "$last_login": new Date(),
        "$first_name": "{{ request.session.first_name }}",
        "$last_name": "{{ request.session.last_name }}",
        "$Role": "{{ request.session.role }}",
        "$Organization": "{{ request.session.company }}".toUpperCase(),
        "$Language": localStorage['lang'],
    });
    var userEmail = "{{ request.session.username }}";
    var userRole = "{{ request.session.role }}";
    var lastLogin = "{{ request.session.last_login }}";
    var Organization = "{{ request.session.company }}";
    var userName = "{{ request.session.first_name }} {{ request.session.last_name }}";
    function goDash(){
      location = BASE.url + "dashboard#/home";
    }
    function goSearch(){
      location = BASE.url + "dashboard#!/project";
    }
    </script>
  </head>
  <body ng-cloak ng-app="FluidIntegrates">
    <div class="am-wrapper">
      <nav class="navbar navbar-default navbar-fixed-top am-top-header">
        <div class="container-fluid">
          <div class="navbar-header">
            <div class="page-title">
              <span>Dashboard</span>
            </div>
            <a href="#" class="am-toggle-left-sidebar navbar-toggle collapsed"><span class="icon-bar"><span></span><span></span><span></span></span></a><a onclick="goDash();" class="navbar-brand"></a><style>.navbar-brand:hover{ cursor:pointer;}</style>
          </div><a href="#" data-toggle="collapse" data-target="#am-navbar-collapse" class="am-toggle-top-header-menu collapsed"><span class="icon s7-angle-down"></span></a>
          <div id="am-navbar-collapse" class="collapse navbar-collapse" ng-controller="dashboardCtrl">
            <ul class="nav navbar-nav am-nav-right">
            <li><a ui-sref="home" style="font-family: open sans;font-size: 2em;"><b>Integrates by FLUIDAttacks</b></a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right am-icons-nav">
              <li><a ng-click="changeLang('es');"><img src="assets/img/spain.png" width="20" height="20"/></a></li>
              <li><a ng-click="changeLang('en');"><img src="assets/img/usa.png" width="20" height="20"/></a></li>
              <li class="dropdown">
                <a href="" ng-click="logout();" data-toggle="dropdown" role="button" aria-expanded="false" class="dropdown-toggle" title="Salir">
                  <span class="icon s7-power"></span>
                </a>
                <!-- START: MODAL LOGOUT -->
                <script type="text/ng-template" id="logout.html">
                    <div class="modal-header">
                        <h3 class="modal-title" id="modal-title">{% templatetag openvariable %}'logout.title'| translate{% templatetag closevariable %}</h3>
                    </div>
                    <div class="modal-body" id="modal-body">
                        <p>{% templatetag openvariable %}'logout.message'| translate{% templatetag closevariable %}</p>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-warning" type="button" ng-click="closeModalLogout()">{% templatetag openvariable %}'logout.cancel'| translate{% templatetag closevariable %}</button>
                        <button class="btn btn-primary" type="button" ng-click="okModalLogout()">{% templatetag openvariable %}'logout.ok'| translate{% templatetag closevariable %}</button>
                    </div>
                </script>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <div class="am-left-sidebar" style="position: fixed;">
        <div class="content">
          <div class="am-logo"></div>
          <ul class="sidebar-elements">
            <script>
                $(document).ready(function() {
                    if (userRole == "customer"){
                        $('#event_button').hide();
                        $('#project_button').hide();
                        $('#forms_button').hide();
                    }
                });
            </script>
            <li class="parent"
                 id="project_button" onclick="goSearch();"><a onclick="goSearch();">
              <i class="icon s7-id"></i><span>{% templatetag openvariable %} 'left_menu.first' | translate {% templatetag closevariable %}</span></a></li>
            <li id="event_button" class="parent"><a ui-sref="EventualitiesByName"><i class="icon s7-way"></i><span>{% templatetag openvariable %} 'left_menu.second' | translate {% templatetag closevariable %}</span></a></li>
            <li id="forms_button" class="parent"><a ui-sref="Forms"><i class="icon s7-note2"></i><span>{% templatetag openvariable %} 'left_menu.third' | translate {% templatetag closevariable %}</span></a></li>
          </ul>
          <!--Sidebar bottom content-->
        </div>
      </div>
      <div class="am-content">
        <div ui-view></div>
      </div>
    </div>
    <div id="full_loader" style="margin: 0px; padding: 0px; position: fixed; right: 0px; top: 0px; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 30001; opacity: 0.8; display:none;">
      <p style="position: absolute; color: White; top: 50%; left: 45%; text-align:center;">
        <img src="assets/img/loading.gif" width="120" height="120"><br>
        Powered By FLUID
      </p>
    </div>
    <script src="assets/amaretti/js/main.js" type="text/javascript"></script>
    <script src="assets/amaretti/lib/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="assets/bower_components/angular/angular.min.js"></script>
    <script src="assets/bower_components/angular-translate/angular-translate.min.js"></script>
    <script src="assets/bower_components/angular-sanitize/angular-sanitize.min.js"></script>
    <script src="assets/amaretti/lib/jquery.gritter/js/jquery.gritter.js" type="text/javascript"></script>
    <script src="assets/bower_components/angular-ui-router/release/angular-ui-router.min.js"></script>
    <script src="assets/bower_components/bootstrap-table/dist/js/bootstrap-table.min.js"></script>
    <script src="assets/bower_components/bootstrap-table/dist/js/bootstrap-table-es-CO.min.js"></script>
    <script src="assets/bower_components/bootstrap-table/cookie/bootstrap-table-cookie.min.js"></script>
    <script src="assets/bower_components/bootstrap-table/export/bootstrap-table-export.min.js"></script>
    <script src="assets/bower_components/bootstrap-table/export/tableExport.js"></script>
    <script src="assets/bower_components/angular-bootstrap/ui-bootstrap.min.js"></script>
    <script src="assets/bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js"></script>
    <script src="assets/bower_components/datepicker/dist/js/bootstrap-datepicker.min.js"></script>
    <script src="assets/bower_components/datepicker/dist/locales/bootstrap-datepicker.es.min.js"></script>
    <script src="assets/bower_components/ng-notify/dist/ng-notify.min.js"></script>
    <script src="assets/bower_components/raphael/raphael.js"></script>
    <script src="assets/prismjs/angular-prismjs.js"></script>
    <script src="assets/node_modules/angular-elastic/elastic.js"></script>
    <script src="/assets/node_modules/jquery-match-height/jquery.matchHeight.js"></script>
    <script src="assets/node_modules/ng-rollbar/ng-rollbar.min.js"></script>
    <script src="assets/bower_components/morris.js/morris.min.js"></script>
    <script>
      Morris.Donut.prototype.resizeHandler = function () {
        this.timeoutId = null;
        if (this.el && this.el.width() > 0 && this.el.height() > 0) {
            this.raphael.setSize(this.el.width(), this.el.height());
            return this.redraw();
        }
        else return null;
    };
    Morris.Donut.prototype.setData = function (data) {
        var row;
        this.data = data;
        this.values = (function () {
            var _i, _len, _ref, _results;
            _ref = this.data;
            _results = [];
            for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                row = _ref[_i];
                _results.push(parseFloat(row.value));
            }
            return _results;
        }).call(this);
        if (this.el && this.el.width() > 0 && this.el.height() > 0) {
            return this.redraw();
        }
        else return null;
    };
    </script>
    <script src="assets/bower_components/angular-morris/build/module/angular-morris/angular-morris.min.js"></script>
    <script src="assets/bower_components/downloadjs/download.js"></script>
    <script src="assets/node_modules/magnific-popup/dist/jquery.magnific-popup.min.js"></script>
    <script src="assets/node_modules/iframe-resizer/js/iframeResizer.min.js"></script>
    <script src="assets/node_modules/jquery-comments_brainkit/js/jquery-comments.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.textcomplete/1.8.0/jquery.textcomplete.js"></script>
    <script src="assets/app/mixPanelDashboard.js"></script>
    <script src="assets/app/app.js"></script>
    <script src="assets/app/translations.js"></script>
    <script src="assets/app/routes.js"></script>
    <script src="assets/app/CSSV2.js"></script>
    <script src="assets/app/xhr.js"></script>
    <script src="assets/app/models/findingFactory.js" type="text/javascript"></script>
    <script src="assets/app/models/eventualityFactory.js" type="text/javascript"></script>
    <script src="assets/app/controllers/eventualityController.js" type="text/javascript"></script>
    <!-- Start Dashboard -->
    <script src="assets/app/models/dashboardFtry.js" type="text/javascript"></script>
    <script src="assets/app/controllers/dashboardCtrl.js" type="text/javascript"></script>
    <!-- End Dashboard -->
    <!-- Start Project -->
    <script src="assets/app/models/projectFtry.js" type="text/javascript"></script>
    <script src="assets/app/controllers/projectCtrl.js" type="text/javascript"></script>
    <!-- End Project -->
    <script src="assets/app/controllers/findingcontentCtrl.js" type="text/javascript"></script>
    <script src="assets/app/controllers/formCtrl.js" type="text/javascript"></script>
    {% csrf_token %}
    <script type="text/javascript">
      $(document).ready(function(){
        //initialize the javascript
        App.init();
      });

    </script>
{% intercom_tag %}
  </body>
</html>
