<div class="page-head">
    <ol class="breadcrumb">
        <li>{{'search_findings.page_head.breadcrumb.project' | translate}}</li>
        <li><a class="text-uppercase">{{project}}</a></li>
    </ol>
</div>
<!-- Start FindingContent -->
<div class="main-content" style="background-color: white;">
  <div class="row">
      <div class="col-md-2 col-xs-12 col-sm-12">
          <button class="btn btn-default btn-block" ng-click="goBack();">
              <i class="icon s7-angle-left"></i> {{'search_findings.project_buttons.back' | translate}}
          </button>
      </div>
      <div class="col-md-8 col-xs-12 col-sm-12 text-left">
          <h2 style="margin-top:0px !important;">{{header.findingTitle}}</h2>
      </div>
      <div class="col-md-2 col-xs-12 col-sm-12" ng-show="isManager">
          <button class="btn btn-danger btn-block" ng-click="deleteFinding();">
              <i class="icon s7-trash"></i> {{'search_findings.project_buttons.delete' | translate}}
          </button>
      </div>
      <div class="col-md-12 col-xs-12 col-sm-12">
          <hr/>
      </div>
  </div>
  <div class="row">

  </div>
  <div class="row">
      <div class="col-sm-12 col-md-12">
          <div class="row">
              <div class="col-md-2 col-sm-6 col-xs-6 text-right">ID</div>
              <div class="col-md-2 col-sm-6 col-xs-6"  style="padding-bottom: 10px;">
                  <span class="label label-default">{{header.findingID}}</span>
              </div>
              <div class="col-md-2 col-sm-6 col-xs-6 text-right">{{'search_findings.project_labels.type' | translate}}</div>
              <div class="col-md-2 col-sm-6 col-xs-6"  style="padding-bottom: 10px;">
                  <span class="label label-default">{{header.findingType}}</span>
              </div>
              <div class="col-md-2 col-sm-6 col-xs-6 text-right">{{'search_findings.project_labels.criticity' | translate}}</div>
              <div class="col-md-2 col-sm-6 col-xs-6"  style="padding-bottom: 10px;">
                      <span class="label label-default" style="{{header.findingValueColor}}">{{header.findingValue}} {{header.findingValueDescription}}</span>
              </div>
          </div>
          <div class="row">
              <div class="col-md-2 col-sm-6 col-xs-6 text-right">{{'search_findings.project_labels.vulnerabilities' | translate}}</div>
              <div class="col-md-2 col-sm-6 col-xs-6"  style="padding-bottom: 10px;">
                  <span class="label label-default">{{header.findingCount}}</span>
              </div>
              <div class="col-md-2 col-sm-6 col-xs-6 text-right">{{'search_findings.project_labels.status' | translate}}</div>
              <div class="col-md-2 col-sm-6 col-xs-6"  style="padding-bottom: 10px;">
                  <span class="label label-default" style="{{header.findingStateColor}}">{{header.findingState}}</span>
              </div>
              <div class="col-md-2 col-sm-6 col-xs-6 text-right">{{'search_findings.project_labels.report' | translate}}</div>
              <div class="col-md-2 col-sm-6 col-xs-6"  style="padding-bottom: 10px;">
                  <span class="label label-default control-label">{{finding.timestamp}}</span>
              </div>
            </div>
            <div class="row">
              <div class="col-md-2 col-sm-6 col-xs-6 text-right">{{'search_findings.project_labels.project' | translate}}</div>
              <div class="col-md-2 col-sm-6 col-xs-6">{{finding.proyecto_fluid}}</div>
              <div class="col-md-2 col-sm-6 col-xs-6 text-right">{{'search_findings.project_labels.client' | translate}}</div>
              <div class="col-md-2 col-sm-6 col-xs-6">{{finding.proyecto_cliente}}</div>
              <div class="col-md-2 col-sm-6 col-xs-6 text-right">{{'search_findings.tab_description.treatment' | translate}}</div>
              <div class="col-md-2 col-sm-6 col-xs-6">{{header.findingTreatment}}</div>
          </div>
      </div>
      <div class="col-sm-12 col-md-12" style="margin-top:10px;">
          <!-- Start Tab Set -->
          <div class="tab-container">
              <ul class="nav pills-tabs nav-justified" style="background-color: white; border-bottom: 1px #eee solid;">
                  <li id="infoItem" class="active" style="font-size:16px;" ng-click="urlDescription();" >
                      <a href="#info" data-toggle="tab" aria-expanded="false">
                      <i class="icon s7-note2" ></i>&nbsp;{{'search_findings.tab_description.description_name' | translate}}</a>
                  </li>
                  <li id="cssv2Item" class="" style="font-size:16px;" ng-click="urlSeverity();">
                      <a href="#cssv2" data-toggle="tab" aria-expanded="false" >
                      <i class="icon s7-calculator" ></i>&nbsp;{{'search_findings.tab_cssv2.description_name' | translate}}</a>
                  </li>
                  <li id="evidenceItem" style="font-size:16px;" ng-click="urlEvidence();">
                      <a href="#evidence" data-toggle="tab">
                      <i class="icon s7-photo"></i>&nbsp;{{'search_findings.tab_evidence.evidence_name' | translate}}</a>
                  </li>
                  <li id="exploitItem" style="font-size:16px;" ng-show="hasExploit" ng-click="urlExploit();">
                      <a href="#exploit" data-toggle="tab">
                      <i class="icon s7-file"></i>&nbsp;Exploit</a>
                  </li>
                  <li id="trackingItem" class="" style="font-size:16px;" ng-click="urlTracking();">
                      <a href="#tracking" data-toggle="tab" aria-expanded="true">
                      <i class="icon s7-graph1"></i>&nbsp;Tracking</a>
                  </li>
                  <li id="recordsItem" class="" style="font-size:16px;" ng-show="hasRecords" ng-click="urlRecords();">
                      <a href="#records" data-toggle="tab" aria-expanded="true">
                      <i class="icon s7-notebook"></i>&nbsp;{{'search_findings.tab_records.records_name' | translate}}</a>
                  </li>
                  <li id="commentItem" style="font-size:16px;" ng-click="urlComments();">
                      <a href="#comment" data-toggle="tab">
                      <i class="icon s7-comment"></i>&nbsp;{{'search_findings.tab_comments.comments_name' | translate}}</a>
                  </li>
              </ul>
              <!-- Start Tabs -->
              <div class="tab-content">
                  <!-- Start Tab Info -->
                  <div id="info" class="tab-pane cont active">
                      <div class="row">
                          <div class="col-md-12 col-sm-12 col-xs-12">
                              <div class="row table-row" ng-show="isManager">
                                  <div class="row">
                                      <div class="col-md-2 col-md-offset-10 col-xs-12 col-sm-12">
                                          <button id="edit" class="btn btn-primary btn-block"
                                                  ng-click="descriptionEditable();">
                                                  <i class="glyphicon glyphicon-edit"></i>  {{'search_findings.tab_description.editable' | translate}}
                                          </button>
                                      </div>
                                  </div>
                                  <br>
                                  <div class="row">
                                      <div class="col-md-2 col-md-offset-10 col-xs-12 col-sm-12">
                                          <button class="btn btn-success btn-block"
                                                  ng-show="!onlyReadableTab1"
                                                  ng-click="updateDescription();">
                                                  <i class="glyphicon glyphicon-repeat"></i>  {{'search_findings.tab_description.update' | translate}}
                                          </button>
                                      </div>
                                  </div>
                              </div>
                              <div class="finding-treatment row table-row" style="display: none;">
                                <div class="row">
                                  <div class="col-md-2 col-md-offset-3 col-xs-12 col-sm-12"> 
                                      <button  id="edit" class="btn btn-primary btn-block"
                                            ng-click="treatmentEditable();"
                                            <i class="glyphicon glyphicon-edit"></i>{{'search_findings.tab_description.edit_treatment' | translate}}
                                      </button>
                                  </div>
                                  <div class="col-md-2 col-md-offset-4 col-xs-12 col-sm-12">
                                      <button id="Treatment" class="btn btn-primary btn-block"
                                              ng-click="findingSolved();"
                                              ng-disabled="isRemediated">
                                              {{'search_findings.tab_description.remediated' | translate}}
                                      </button>
                                  </div>
                                </div>
                              </div>
                              <div class="finding-verified row table-row" style="display: none;">
                                <div class="row">
                                  <div class="col-md-2 col-md-offset-10 col-xs-12 col-sm-12">
                                      <button id="verified" class="btn btn-warning btn-block"
                                              ng-click="findingVerified();">
                                              <i class="glyphicon glyphicon-ok"></i>  {{'search_findings.tab_description.verified' | translate}}
                                      </button>
                                  </div>
                                </div>
                              </div>
                              <div class="row table-row" ng-show="isManager && !onlyReadableTab1">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.type' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.nivel}}</p>
                                      <select ng-model="finding.nivel"
                                              ng-show="!onlyReadableTab1"
                                              ng-change="detectNivel();"
                                              class="form-control">
                                          <option value="Detallado">{{'search_findings.tab_description.detailed' | translate}}</option>
                                          <option value="General">{{'search_findings.tab_description.general' | translate}}</option>
                                      </select>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.title' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.hallazgo}}</p>
                                      <input type="text" class="form-control"
                                             ng-show="!onlyReadableTab1"
                                             ng-model="finding.hallazgo"/>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.stage' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.escenario}}</p>
                                      <select ng-model="finding.escenario"
                                              ng-show="!onlyReadableTab1"
                                              class="form-control">
                                          <option ng-repeat="item in list.scenario"
                                                  value="{{item.name}}">{{item.name}}</option>
                                      </select>
                                  </div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>Actor</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.actor}}</p>
                                      <select ng-model="finding.actor"
                                              ng-show="!onlyReadableTab1"
                                              class="form-control">
                                          <option ng-repeat="item in list.actor"
                                                  value="{{item.name}}">{{item.name}}</option>
                                      </select>
                                  </div>
                              </div>
                              <div class="row table-row" ng-show="esDetallado">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.category' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.categoria}}</p>
                                      <select ng-model="finding.categoria"
                                              ng-show="!onlyReadableTab1"
                                              class="form-control">
                                          <option ng-repeat="item in list.categories"
                                                  value="{{item.name}}">
                                              {{item.name}}
                                          </option>
                                      </select>
                                  </div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.risk' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.valor_riesgo}}</p>
                                      <input type="text" class="form-control"
                                             ng-show="!onlyReadableTab1"
                                             ng-model="finding.valor_riesgo" disabled/>
                                  </div>
                              </div>
                              <div class="row table-row" ng-show="esDetallado">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.probability' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.probabilidad}}</p>
                                      <select ng-model="finding.probabilidad"
                                              ng-show="!onlyReadableTab1"
                                              ng-change="findingCalculateSeveridad();"
                                              class="form-control">
                                          <option ng-repeat="item in list.probability"
                                                  value="{{item.name}}">
                                              {{item.name}}
                                          </option>
                                      </select>
                                  </div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.severity' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.severidad}}</p>
                                      <input type="text" class="form-control"
                                             ng-show="!onlyReadableTab1"
                                             ng-model="finding.severidad"
                                             ng-bind="finding.severidad"
                                             ng-blur="calculateSeveridad();">
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.description' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.vulnerabilidad}}</p>
                                      <textarea class="form-control no-resize"
                                                ng-show="!onlyReadableTab1"
                                                ng-model="finding.vulnerabilidad">{{finding.vulnerabilidad}}</textarea>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.requirements' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.requisitos}}</p>
                                      <textarea class="form-control no-resize"
                                                ng-show="!onlyReadableTab1"
                                                ng-model="finding.requisitos">{{finding.requisitos}}</textarea>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.where' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <textarea msd-elastic class="form-control" rows="4"
                                                ng-show="onlyReadableTab1"
                                                disabled style="margin-bottom: 5px;"
                                                ng-model="finding.donde">{{finding.donde}}</textarea>
                                      <textarea msd-elastic class="form-control" rows="4" style="margin-bottom: 5px;"
                                                ng-show="!onlyReadableTab1"
                                                ng-model="finding.donde">{{finding.donde}}</textarea>
                                  </div>
                              </div>
                              <div class="row table-row" ng-show="!onlyReadableTab1">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.cardinality' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.cardinalidad}}</p>
                                      <input type="text" class="form-control"
                                             ng-show="!onlyReadableTab1"
                                             ng-model="finding.cardinalidad">
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.vectors' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.vector_ataque}}</p>
                                      <textarea class="form-control no-resize"
                                                ng-show="!onlyReadableTab1"
                                                ng-model="finding.vector_ataque">{{finding.vector_ataque}}</textarea>
                                  </div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.threat' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.amenaza}}</p>
                                      <textarea class="form-control no-resize"
                                                ng-show="!onlyReadableTab1"
                                                ng-model="finding.amenaza">{{finding.amenaza}}</textarea>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.recommendation' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.solucion_efecto}}</p>
                                      <textarea class="form-control no-resize"
                                                ng-show="!onlyReadableTab1"
                                                ng-model="finding.solucion_efecto">{{finding.solucion_efecto}}</textarea>
                                  </div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.system' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.sistema_comprometido}}</p>
                                      <textarea class="form-control no-resize"
                                                ng-show="!onlyReadableTab1"
                                                ng-model="finding.sistema_comprometido">{{finding.sistema_comprometido}}</textarea>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.records' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.registros}}</p>
                                      <textarea class="form-control no-resize"
                                                ng-show="!onlyReadableTab1"
                                                ng-model="finding.registros">{{finding.registros}}</textarea>
                                  </div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.totalrecords' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.registros_num}}</p>
                                      <textarea class="form-control no-resize"
                                                ng-show="!onlyReadableTab1"
                                                ng-model="finding.registros_num">{{finding.registros_num}}</textarea>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.weakness' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab1">{{finding.cwe}}</p>
                                      <input type="text" class="form-control"
                                             ng-show="!onlyReadableTab1"
                                             ng-model="finding.cwe">
                                  </div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.bts_external' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab4">{{finding.bts_externo}}</p>
                                      <input type="text" class="form-control"
                                             ng-show="!onlyReadableTab4"
                                             ng-model="finding.bts_externo">
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head" ng-show="!onlyReadableTab4"><label><b>{{'search_findings.tab_description.treatment' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc" ng-show="!onlyReadableTab4">
                                      <p ng-show="onlyReadableTab4"ng-show="!onlyReadableTab4">{{finding.tratamiento}}</p>
                                      <select ng-model="finding.tratamiento"
                                              ng-click="validateTreatment();"
                                              ng-show="!onlyReadableTab4"
                                              class="form-control">
                                          <option ng-repeat="item in list.treatment"
                                                  value="{{item.name}}">
                                              {{item.name}}
                                          </option>
                                      </select>
                                  </div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.treat_justification' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab4">{{finding.razon_tratamiento}}</p>
                                      <textarea class="form-control no-resize"
                                                ng-show="!onlyReadableTab4"
                                                ng-model="finding.razon_tratamiento">{{finding.razon_tratamiento}}</textarea>
                                  </div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_description.treat_manager' | translate}}</b></label></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-desc">
                                      <p>{{finding.responsable_tratamiento}}</p>
                                  </div>
                              </div>
                              <div class="row table-row" ng-show="!isManager">
                                <div class="row">
                                  <div class="col-md-2 col-md-offset-10 col-xs-12 col-sm-12">
                                    <button class="btn btn-success btn-block"
                                            ng-show="!onlyReadableTab4"
                                            ng-click="updateTreatment();"
                                            <i class="glyphicon glyphicon-repeat"></i>  {{'search_findings.tab_description.update_treatment' | translate}}
                                    </button>
                                  </div>
                                </div>
                              </div>
                         </div>
                      </div>
                  </div>
                  <!-- End Tab Info -->
                  <!-- Start Tab Cssv2 -->
                  <div id="cssv2" class="tab-pane cont">
                      <div class="row">
                          <div class="col-md-12 col-sm-12 col-xs-12">
                              <div class="row table-row" ng-show="isManager">
                                  <div class="row">
                                      <div class="col-md-2 col-md-offset-10 col-xs-12 col-sm-12">
                                          <button class="btn btn-primary btn-block"
                                              ng-click="cssv2Editable();">
                                              <i class="glyphicon glyphicon-edit"></i>  {{'search_findings.tab_cssv2.editable' | translate}}
                                          </button>
                                      </div>
                                  </div>
                                  <br>
                                  <div class="row">
                                      <div class="col-md-2 col-md-offset-10 col-xs-12 col-sm-12">
                                          <button class="btn btn-success btn-block"
                                              ng-show="!onlyReadableTab2"
                                              ng-click="updateCSSv2();">
                                              <i class="glyphicon glyphicon-repeat"></i>  {{'search_findings.tab_cssv2.update' | translate}}
                                          </button>
                                      </div>
                                  </div>

                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_cssv2.vector' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab2">{{finding.vector_acceso}}</p>
                                      <select ng-model="finding.vector_acceso"
                                              ng-show="!onlyReadableTab2"
                                              ng-change="findingCalculateCSSv2();"
                                              class="form-control">
                                          <option ng-repeat="item in list.accessVector"
                                                  value="{{item.value + ' | ' + item.name}}">
                                              {{item.name}}
                                          </option>
                                      </select>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_cssv2.confidenciality' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab2">{{finding.impacto_confidencialidad}}</p>
                                      <select ng-model="finding.impacto_confidencialidad"
                                              ng-show="!onlyReadableTab2"
                                              ng-change="findingCalculateCSSv2();"
                                              class="form-control">
                                          <option ng-repeat="item in list.confidenciality"
                                                  value="{{item.value + ' | ' + item.name}}">
                                              {{item.name}}
                                          </option>
                                      </select>
                                  </div>
                              </div><div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_cssv2.integrity' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab2">{{finding.impacto_integridad}}</p>
                                      <select ng-model="finding.impacto_integridad"
                                              ng-show="!onlyReadableTab2"
                                              ng-change="findingCalculateCSSv2();"
                                              class="form-control">
                                          <option ng-repeat="item in list.integrity"
                                                  value="{{item.value + ' | ' + item.name}}">
                                              {{item.name}}
                                          </option>
                                      </select>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_cssv2.availability' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab2">{{finding.impacto_disponibilidad}}</p>
                                      <select ng-model="finding.impacto_disponibilidad"
                                              ng-show="!onlyReadableTab2"
                                              ng-change="findingCalculateCSSv2();"
                                              class="form-control">
                                          <option ng-repeat="item in list.availability"
                                                  value="{{item.value + ' | ' + item.name}}">
                                              {{item.name}}
                                          </option>
                                      </select>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_cssv2.authentication' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab2">{{finding.autenticacion}}</p>
                                      <select ng-model="finding.autenticacion"
                                              ng-show="!onlyReadableTab2"
                                              ng-change="findingCalculateCSSv2();"
                                              class="form-control">
                                          <option ng-repeat="item in list.authentication"
                                                  value="{{item.value + ' | ' + item.name}}">
                                                  {{item.name}}
                                          </option>
                                      </select>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_cssv2.exploitability' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab2">{{finding.explotabilidad}}</p>
                                      <select ng-model="finding.explotabilidad"
                                              ng-show="!onlyReadableTab2"
                                              ng-change="findingCalculateCSSv2();"
                                              class="form-control">
                                          <option ng-repeat="item in list.explotability"
                                                  value="{{item.value + ' | ' + item.name}}">
                                                  {{item.name}}
                                          </option>
                                      </select>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_cssv2.confidence' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab2">{{finding.nivel_confianza}}</p>
                                      <select ng-model="finding.nivel_confianza"
                                              ng-show="!onlyReadableTab2"
                                              ng-change="findingCalculateCSSv2();"
                                              class="form-control">
                                          <option ng-repeat="item in list.realiabilityLevel"
                                                  value="{{item.value + ' | ' + item.name}}">
                                              {{item.name}}
                                          </option>
                                      </select>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_cssv2.resolution' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab2">{{finding.nivel_resolucion}}</p>
                                      <select ng-model="finding.nivel_resolucion"
                                              ng-show="!onlyReadableTab2"
                                              ng-change="findingCalculateCSSv2();"
                                              class="form-control">
                                          <option ng-repeat="item in list.resolutionLevel"
                                                  value="{{item.value + ' | ' + item.name}}">
                                              {{item.name}}
                                          </option>
                                      </select>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>{{'search_findings.tab_cssv2.complexity' | translate}}</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc">
                                      <p ng-show="onlyReadableTab2">{{finding.complejidad_acceso}}</p>
                                      <select ng-model="finding.complejidad_acceso"
                                              ng-show="!onlyReadableTab2"
                                              ng-change="findingCalculateCSSv2();"
                                              class="form-control">
                                          <option ng-repeat="item in list.accessComplexity"
                                                  value="{{item.value + ' | ' + item.name}}">
                                              {{item.name}}
                                          </option>
                                      </select>
                                  </div>
                              </div>
                              <div class="row table-row">
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>CVSS v2 Base</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc"><p>{{finding.cssv2base}}</p></div>
                                  <div class="col-md-3 col-xs-12 col-sm-12 table-head"><label><b>CVSS v2 Temporal</b></label></div>
                                  <div class="col-md-9 col-xs-12 col-sm-12 table-desc"><p>{{finding.criticidad}}</p></div>
                              </div>
                          </div>
                      </div>
                  </div>
                  <!-- End Tab CSSv2 -->
                  <!-- Start Tab Evidence -->
                  <div id="evidence" class="tab-pane cont">
                      <div class="row" ng-show="isManager" style="margin-bottom: 10px;">
                          <div class="col-md-2 col-md-offset-10 col-xs-12 col-sm-12">
                              <button class="btn btn-primary btn-block"
                                      ng-click="evidenceEditable();">
                                  <i class="glyphicon glyphicon-edit"></i>  {{'search_findings.tab_evidence.editable' | translate}}
                              </button>
                          </div>
                      </div>
                      <div class="popup-gallery">
                        <div class="row">
                            <div ng-repeat="ev in tabEvidences">
                                <div class="col-md-4 col-sm-6 col-xs-12 equalHeight">
                                    <div class="panel panel-default" ng-show="onlyReadableTab3" ng-if="ev.desc != ''">
                                      <div class="panel-body">
                                        <div mag-thumb="inner-inline" mag-flow="inline">
                                            <a ng-href="{{ev.url || ''}}" title="{{ev.desc}}">
                                                <img ng-src="{{ev.url || ''}}"
                                                    style="max-width:100%;"
                                                    class="integrates-image img-thumbnail img-responsive"
                                                    width="600" height="600"/>
                                            </a>
                                        </div>
                                      </div>
                                      <div class="panel-footer" style="background-color: #fff;">
                                        <div class="row">
                                            <label><b>{{'search_findings.tab_evidence.detail' | translate}}</b></label>
                                        </div>
                                        <div class="row">
                                            <p ng-show="onlyReadableTab3">{{ev.desc}}</p>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="panel panel-default" ng-show="!onlyReadableTab3">
                                      <div class="panel-body">
                                        <div class="row" style="text-align: center;">
                                            <label><b>{{ev.name || ''}}</b></label>
                                        </div>
                                        <div mag-thumb="inner-inline" mag-flow="inline">
                                            <img ng-src="{{ev.url || ''}}"
                                                style="max-width:100%;"
                                                class="integrates-image img-thumbnail img-responsive"
                                                width="600" height="600"/>
                                        </div>
                                      </div>
                                      <div class="panel-footer" style="background-color: #fff;">
                                        <div class="row">
                                            <div class="box" style="text-align: center;">
                                                <input type="file"
                                                    name="evidence{{ev.ref}}[]"
                                                    id="evidence{{ev.ref}}"
                                                    class="inputfile inputfile-evidence"
                                                    ng-show="!onlyReadableTab3"
                                                    enctype="multipart/form-data"
                                                    accept="image/gif, image/png"/>
                                            <label for="evidence{{ev.ref}}"><span></span> <strong><i class="glyphicon glyphicon-search"></i> Choose a file&hellip;</strong></label>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <label><b>{{'search_findings.tab_evidence.detail' | translate}}</b></label>
                                        </div>
                                        <div class="row">
                                            <div>
                                                <textarea class="form-control"
                                                      ng-show="!onlyReadableTab3"
                                                      id="evidenceText{{ev.ref}}"
                                                      ng-if="ev.ref != '0' && ev.ref != '1'">{{ev.desc}}</textarea>
                                                <button class="btn btn-success btn-block"
                                                        ng-show="!onlyReadableTab3"
                                                        reference="{{ev.ref}}"
                                                        target="{{ev.ref}}"
                                                        onclick="updateEvidenceText(this);">
                                                        <i class="glyphicon glyphicon-repeat"></i>  {{'search_findings.tab_evidence.update' | translate}}
                                                </button>
                                            </div>
                                        </div>
                                      </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                  </div>
                  <!-- End Tab Evidence -->
                  <!-- Start Tab Exploit -->
                  <div id="exploit" class="tab-pane cont" ng-show="hasExploit">
                    <div class="row" ng-show="isManager" style="margin-bottom: 10px;">
                        <div class="row">
                            <div class="col-md-2 col-md-offset-10 col-xs-12 col-sm-12">
                                <button class="btn btn-primary btn-block"
                                        ng-click="exploitEditable();">
                                    <i class="glyphicon glyphicon-edit"></i>  {{'search_findings.tab_evidence.editable' | translate}}
                                </button>
                            </div>
                        </div>
                        <div class="row" style="margin-top: 15px;">
                            <div class="col-md-4 col-md-offset-6 col-xs-12 col-sm-12">
                                <div class="box" style="text-align: center;" ng-show="!onlyReadableTab5">
                                    <input type="file"
                                            name="evidence7[]"
                                            id ="evidence7"
                                            class="inputfile inputfile-evidence"
                                            ng-show="!onlyReadableTab5"
                                            enctype="multipart/form-data"
                                            accept=".py"/>
                                    <label for="evidence7"><span></span> <strong><i class="glyphicon glyphicon-search"></i> Choose a file&hellip;</strong></label>
                                </div>

                            </div>
                        <div class="col-sm-2" style="text-align: center;">
                              <button ng-show="!onlyReadableTab5"
                                      target="7"
                                      onclick="updateEvidencesFiles(this);"
                                      class = "btn btn-primary btn-block">
                                      <i class="glyphicon glyphicon-cloud-upload"></i>  {{'search_findings.tab_evidence.update' | translate}}
                              </button>
                            </div>
                        </div>

                    </div>
                      <pre prism-highlight source="{{exploitURL}}" class="language-python line-numbers"></pre>
                  </div>
                  <!-- End Tab Exploit -->
                  <!-- Start Tab Tracking -->
                  <div id="tracking" class="tab-pane cont">
                      <div class="row">
                          <div class="col-md-12">
                              <p>{{'search_findings.tab_tracking.open' | translate}}</p>
                              <textarea msd-elastic ng-model="finding.donde" class="form-control" disabled>{{finding.donde}}</textarea>
                          </div>
                          <div class="col-md-12">
                              <p>{{'search_findings.tab_tracking.close' | translate}}</p>
                              <textarea msd-elastic ng-model="finding.cerradas" class="form-control" disabled>{{finding.cerradas}}</textarea>
                          </div>
                      </div>
                      <div class="row">
                          <div class="col-md-12">
                              <ul class="timeline">
                                  <li class="timeline-item text-left">
                                      <div class="timeline-date"><span>{{finding.timestamp}}</span></div>
                                      <div class="timeline-content">
                                          <table class="table table-bordered table-responsive" style="max-width: 350px;">
                                              <tr class="text-center">
                                                  <td colspan="2"><b>{{'search_findings.tab_tracking.finding' | translate}}</b></td>
                                              </tr>
                                          </table>
                                      </div>
                                  </li>
                                  <li class="timeline-item" ng-repeat="x in finding.cierres">
                                      <div class="timeline-date"><span>{{x.timestamp}} </span></div>
                                      <div class="timeline-content">
                                          <table class="table table-bordered table-responsive" style="max-width: 350px;">
                                              <tr class="text-center">
                                                  <td colspan="2"><b>{{'search_findings.tab_tracking.cicle' | translate}} {{x.position}}</b></td>
                                              </tr>
                                              <tr>
                                                  <td>{{'search_findings.tab_tracking.open' | translate}}</td>
                                                  <td>{{x.abiertas}}</td>
                                              </tr>
                                              <tr>
                                                  <td>{{'search_findings.tab_tracking.close' | translate}}</td>
                                                  <td>{{x.cerradas}}</td>
                                              </tr>
                                          </table>
                                      </div>
                                  </li>
                              </ul>
                          </div>
                      </div>
                  </div>
                  <!-- End Tab Tracking -->
                  <!-- Start Tab Record -->
                  <div id="records" class="tab-pane cont" ng-show="hasRecords">
                      <div class="row" ng-show="isManager" style="margin-bottom: 10px;">
                          <div class="row">
                              <div class="col-md-2 col-md-offset-10 col-xs-12 col-sm-12">
                                  <button class="btn btn-primary btn-block"
                                          ng-click="recordsEditable();">
                                      <i class="glyphicon glyphicon-edit"></i>  {{'search_findings.tab_evidence.editable' | translate}}
                                  </button>
                              </div>
                          </div>
                          <div class="row" style="margin-top: 15px;">
                              <div class="col-md-4 col-md-offset-6 col-xs-12 col-sm-12">
                                  <div class="box" style="text-align: center;" ng-show="!onlyReadableTab6">
                                      <input type="file"
                                              name="evidence8[]"
                                              id ="evidence8"
                                              class="inputfile inputfile-evidence"
                                              ng-show="!onlyReadableTab6"
                                              enctype="multipart/form-data"
                                              accept=".csv"/>
                                      <label for="evidence8"><span></span> <strong><i class="glyphicon glyphicon-search"></i> Choose a file&hellip;</strong></label>
                                  </div>
                              </div>
                              <div class="col-sm-2" style="text-align: center;">
                                <button ng-show="!onlyReadableTab6"
                                        target="8"
                                        onclick="updateEvidencesFiles(this);"
                                        class = "btn btn-primary btn-block">
                                        <i class="glyphicon glyphicon-cloud-upload"></i>  {{'search_findings.tab_evidence.update' | translate}}
                                </button>
                              </div>
                          </div>
                      </div>
                      <div class="row">
                          <table id="recordsTable"
                                   data-click-to-select="false"
                                   data-classes="table table-hover table-striped"
                                   data-striped="true"
                                   data-show-columns="true"
                                   data-cookie="true"
                                   data-show-export="true"
                                   data-export-types="['sql', 'excel', 'csv', 'json']"
                                   data-pagination="true"
                                   data-search="true"
                                   data-page-size="15"
                                   data-toolbar="#toolbar">
                          </table>
                      </div>
                  </div>
                  <!-- End Tab Record -->
                  <!-- Start Tab Comment -->
                  <div id="comment" class="tab-pane cont">
                    <div id="comments-container"></div>
                  </div>
                  <!-- End Tab Comment -->
              </div>
              <!-- End Tabs -->
          </div>
          <!--End Tab Set -->
      </div>
  </div>
</div>
<!-- End FindingContent -->

<!-- Start CommonStyles -->
<style>
    .bg-critical{ background-color: #F12; }
    .bg-moderate{ background-color: #F72; }
    .bg-tolerable{ background-color: #FD2; }
    .no-resize{ resize: none; height: 100px !important;}
    .hide-detallado, .fl-hidden { display: none; }
    .show-detallado, .fl-visible{ display: block;}
    .pills-tabs > li.active > a,
    .pills-tabs > li.active > a:hover,
    .pills-tabs > li.active > a:focus{
        background-color: #eee;
        color: #777;
    }
    .pills-tabs > li > a,
    .pills-tabs > li > a:hover,
    .pills-tabs > li > a:focus{
        background-color: white;
        color: #666;
    }
    .table-head{
        text-align: right;
    }
    @media (max-width: 768px) {
        .table-head{
            text-align: left;
        }
    }
    .table-row{
        margin-top: 15px;
        font-size: 14px;
    }
    .table-desc{
        color: #888;
        text-align: justify;
        /*border-bottom: 0.5px #DDD solid;*/
    }
    #vulnerabilities thead tr{ background-color: #337ab7; color:white;  }
    #eventualities thead tr{ background-color: #337ab7; color:white;  }
    #recordsTable thead tr{ background-color: #337ab7; color:white;  }

</style>
<!-- End CommonStyles -->
